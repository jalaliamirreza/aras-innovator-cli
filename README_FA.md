# راهنمای کاربری Aras Innovator CLI

ابزار خط فرمان و رابط گرافیکی برای ارتباط با سیستم Aras Innovator PLM. این ابزار امکان ایجاد سند، آپلود فایل و اجرای دستورات AML را از طریق رابط خط فرمان و رابط گرافیکی فراهم می‌کند.

## ویژگی‌ها

- **رابط خط فرمان (CLI)**: اجرای کوئری‌ها و دستورات AML
- **رابط گرافیکی (GUI)**: برنامه کاربرپسند Windows Forms برای آپلود سند
- **ایجاد سند**: ایجاد آیتم Document در Aras Innovator
- **آپلود فایل**: آپلود فایل به مخزن Aras با اتصال خودکار
- **یکپارچگی Send To**: کلیک راست روی هر فایل در Windows Explorer برای آپلود مستقیم
- **ذخیره تنظیمات**: ذخیره تنظیمات اتصال برای دسترسی سریع

## نصب

### پیش‌نیازها

- .NET Framework 4.7.2 یا بالاتر
- سیستم عامل Windows
- دسترسی به سرور Aras Innovator

### نصب از کد منبع

1. کلون کردن مخزن:
```bash
git clone https://github.com/jalaliamirreza/aras-innovator-cli.git
cd aras-innovator-cli
```

2. بازگردانی بسته‌های NuGet:
```bash
nuget restore
```

3. کامپایل راه‌حل:
```bash
msbuild ArasCLI.sln /t:Build /p:Configuration=Release
```

فایل اجرایی در مسیر `ArasCLI\bin\Release\ArasCLI.exe` قرار خواهد گرفت.

## نحوه استفاده

### حالت رابط گرافیکی

1. **اجرای رابط گرافیکی**:
   - دوبار کلیک روی `ArasCLI.exe` یا اجرا با فلگ `--gui`
   - رابط گرافیکی به صورت خودکار باز می‌شود اگر هیچ آرگومان خط فرمانی ارائه نشود

2. **پر کردن تنظیمات اتصال**:
   - **آدرس Aras**: آدرس سرور Aras Innovator شما (مثال: `http://server/InnovatorServer`)
   - **پایگاه داده**: نام پایگاه داده (مثال: `InnovatorSolutions`)
   - **کاربر**: نام کاربری Aras شما
   - **رمز عبور**: رمز عبور Aras شما
   - تیک "ذخیره اطلاعات" را بزنید تا آدرس، پایگاه داده و کاربر ذخیره شود (رمز عبور هرگز ذخیره نمی‌شود)

3. **انتخاب فایل برای آپلود**:
   - کلیک روی دکمه "Browse..." برای انتخاب فایل
   - یا تایپ/چسباندن مسیر فایل به صورت مستقیم
   - یا کشیدن و رها کردن فایل در فیلد "File to Upload"

4. **تنظیم ویژگی‌های سند** (اختیاری):
   - **نام سند**: نام سند (اگر خالی باشد از نام فایل پر می‌شود)
   - **شماره آیتم**: شماره آیتم سند (اگر خالی باشد به صورت خودکار تولید می‌شود)

5. **آپلود**:
   - کلیک روی دکمه "Upload to Aras"
   - نظارت بر پیشرفت در ناحیه لاگ
   - وضعیت پیام موفقیت یا خطا را نمایش می‌دهد

### یکپارچگی Send To

1. **تنظیم Send To**:
   - رابط گرافیکی را باز کنید
   - کلیک روی دکمه "Setup Send To..."
   - یک میانبر در پوشه SendTo ویندوز شما ایجاد می‌شود

2. **استفاده از Send To**:
   - کلیک راست روی هر فایل در Windows Explorer
   - انتخاب "Send to" → "Aras Innovator Upload"
   - رابط گرافیکی با فایل از پیش انتخاب شده باز می‌شود
   - تنظیمات اتصال را پر کنید و روی "Upload to Aras" کلیک کنید

### رابط خط فرمان

#### دستور پایه

```bash
ArasCLI.exe -l <url> -d <database> -u <user> -p <password> [options]
```

#### پارامترهای اجباری

- `-l` یا `--url`: آدرس سرور Aras Innovator
- `-d` یا `--database`: نام پایگاه داده
- `-u` یا `--user`: نام کاربری
- `-p` یا `--password`: رمز عبور

#### پارامترهای اختیاری

- `-f` یا `--inputfile`: مسیر فایل AML ورودی
- `-o` یا `--outputfile`: مسیر فایل خروجی برای نتایج
- `-g` یا `--log`: مسیر فایل لاگ
- `-c` یا `--config`: مسیر فایل پیکربندی
- `--create-doc`: فعال‌سازی حالت ایجاد سند
- `--file` یا `-file`: مسیر فایل برای آپلود (با `--create-doc` اجباری است)
- `--name` یا `-name`: نام سند
- `--item-number` یا `-n`: شماره آیتم سند (اگر ارائه نشود به صورت خودکار تولید می‌شود)
- `--gui`: اجرای حالت رابط گرافیکی

#### مثال‌ها

**اجرای فایل AML**:
```bash
ArasCLI.exe -l http://server/InnovatorServer -d InnovatorSolutions -u admin -p innovator -f query.xml
```

**ایجاد سند و آپلود فایل**:
```bash
ArasCLI.exe -l http://server/InnovatorServer -d InnovatorSolutions -u admin -p innovator --create-doc --file "C:\path\to\file.pdf" --name "سند من"
```

**اجرای رابط گرافیکی**:
```bash
ArasCLI.exe --gui
```

**نمایش راهنما**:
```bash
ArasCLI.exe -h
```

## فایل پیکربندی

می‌توانید یک فایل پیکربندی برای ذخیره تنظیمات اتصال ایجاد کنید:

```
l:http://server/InnovatorServer
d:InnovatorSolutions
u:admin
p:innovator
```

استفاده:
```bash
ArasCLI.exe -c config.txt [other options]
```

## جزئیات فنی

### فرآیند آپلود فایل

1. **ایجاد سند**: ایجاد آیتم Document در Aras Innovator
2. **آپلود فایل**: آپلود فایل به مخزن Aras با استفاده از متد `attachPhysicalFile()`
3. **ایجاد رابطه**: ایجاد رابطه Document File برای اتصال فایل به سند
4. **تأیید**: تأیید آپلود و اتصال موفق فایل

## عیب‌یابی

### دکمه Browse پاسخ نمی‌دهد
- مطمئن شوید از آخرین نسخه استفاده می‌کنید
- سعی کنید مسیر فایل را مستقیماً تایپ کنید یا از drag-and-drop استفاده کنید
- لاگ‌های رویداد Windows را برای خطاها بررسی کنید

### خطاهای اتصال
- بررسی کنید آدرس سرور Aras صحیح است
- اتصال شبکه را بررسی کنید
- مطمئن شوید اطلاعات ورود صحیح است
- بررسی کنید نام پایگاه داده با نمونه Aras شما مطابقت دارد

### خطاهای آپلود فایل
- مطمئن شوید مسیر فایل قابل دسترسی است
- مجوزهای فایل را بررسی کنید
- بررسی کنید سرور مخزن Aras در حال اجرا و قابل دسترسی است
- لاگ‌های سرور Aras را برای پیام‌های خطای دقیق بررسی کنید

### Send To کار نمی‌کند
- دوباره "Setup Send To..." را از رابط گرافیکی اجرا کنید
- بررسی کنید میانبر در مسیر زیر وجود دارد: `%APPDATA%\Microsoft\Windows\SendTo\`
- مطمئن شوید مجوز نوشتن در پوشه SendTo را دارید

## مجوز

این پروژه منبع باز است. لطفاً به فایل مجوز برای جزئیات مراجعه کنید.

## مشارکت

مشارکت‌ها خوش‌آمد است! لطفاً pull request ارسال کنید یا issue باز کنید.

## پشتیبانی

برای مشکلات، سوالات یا مشارکت‌ها، لطفاً به مخزن GitHub مراجعه کنید:
https://github.com/jalaliamirreza/aras-innovator-cli

## تاریخچه نسخه

### نسخه 0.1
- انتشار اولیه
- عملکرد CLI برای اجرای AML
- رابط گرافیکی برای ایجاد سند و آپلود فایل
- یکپارچگی Send To
- ذخیره تنظیمات


